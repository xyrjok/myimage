<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æˆ‘çš„å…¬å…±å›¾åº“</title>
    <style>
        body { font-family: system-ui, sans-serif; background: #fafafa; margin: 0; padding: 0; }
        header { background: #fff; padding: 20px; text-align: center; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        h1 { margin: 0; font-size: 24px; color: #333; }
        .container { max-width: 1200px; margin: 30px auto; padding: 0 20px; }
        .masonry { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px; }
        .item { background: #fff; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.05); transition: transform 0.2s; }
        .item:hover { transform: translateY(-5px); box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .item img { width: 100%; display: block; object-fit: cover; aspect-ratio: 1 / 1; }
        .footer { text-align: center; padding: 40px; color: #888; font-size: 14px; }
    </style>
</head>
<body>

<header>
    <h1>ğŸŒŒ æˆ‘çš„å…¬å…±å›¾åº“</h1>
    <p style="color: #666; font-size: 14px;">Powered by Cloudflare Pages & Telegram</p>
</header>

<div class="container">
    <div class="masonry" id="public-gallery">
        <p style="text-align: center; width: 100%; color: #999;">æ­£åœ¨åŠ è½½å›¾åº“...</p>
    </div>
</div>

<div class="footer">
    <a href="/admin.html" style="color: #bbb; text-decoration: none;">ç®¡ç†å‘˜ç™»å½•</a>
</div>

<script>
    // âš ï¸ æ­¤å¤„å¿…é¡»å¡«å…¥ä½ è‡ªå·±çš„ Worker API åŸŸå
    const API_BASE = "https://myimage.137222445.workers.dev"; 

    async function loadPublicImages() {
        const gallery = document.getElementById('public-gallery');
        try {
            // è°ƒç”¨ Worker æä¾›çš„å…¬å¼€è®¿é—® API
            const res = await fetch(`${API_BASE}/api/public/images`);
            const data = await res.json();
            
            if (data.length === 0) {
                gallery.innerHTML = '<p style="text-align:center; width: 100%;">å›¾åº“ç©ºç©ºå¦‚ä¹Ÿ</p>';
                return;
            }

            gallery.innerHTML = data.map(img => `
                <div class="item">
                    <a href="${img.url}" target="_blank">
                        <img src="${img.url}" alt="${img.filename || 'image'}" loading="lazy">
                    </a>
                </div>
            `).join('');
        } catch (err) {
            gallery.innerHTML = '<p style="text-align:center; color: red; width: 100%;">æ— æ³•è¿æ¥åˆ°æœåŠ¡å™¨</p>';
        }
    }

    window.onload = loadPublicImages;
</script>
</body>
</html>
